<!DOCTYPE html><html lang="en"><head><title>d2/ch/chn2</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../"><meta name="groc-document-path" content="d2/ch/chn2"><meta name="groc-project-path" content="js/src/d2/ch/chn2.js"><meta name="groc-github-url" content="https://github.com/aureooms/js-cg"><link rel="stylesheet" type="text/css" media="all" href="../../assets/style.css"><script type="text/javascript" src="../../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/aureooms/js-cg/blob/master/js/src/d2/ch/chn2.js">js/src/d2/ch/chn2.js</a></div></div><div id="document"><div class="segment"></div><div class="segment"><div class="comments "><div class="wrapper"><p>Find the convex hull in O(n^2) by checking for every vertex b that there is
no triangle ( a , u , v ) that contains this point.</p>
<p>Vertex a is an arbitraty vertex in the vertex set. Note that it must be
different from b. If b is not part of the convex hull of the vertex set then
there must exist a segment going from u to v of the vertex set such that we
can project b on this segment along direction ab. For this segment to exist
u and v cannot be on the same side of the line going through a and b. Thus
s( sin( a , b , u ) ) === - s( sin( a , b , v ) ). Also at least one of u
and v must be on the other side of the orthogonal to line ab, otherwise b
would be necessarily a vertex of the convex hull.</p>
<p>Note that cossign is only required to break ties consistently in the case
where the data contains (3 or more)-colinear vertices.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">var</span> __chn2__ = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">( sinsign , cossign )</span> </span>{</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>hypothesis : |set| &gt;= 2</p>
<p>Parameters:</p>
<ul>
<li><p><strong>set must be a set.</strong><br/>(array of vertices)</p>
</li>
<li><p><strong>hull must be a hull.</strong><br/>(inclusion array representation of the convex hull initialized to true)</p>
</li>
</ul></div></div><div class="code"><div class="wrapper">	<span class="hljs-keyword">var</span> chn2 = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">( set , hull )</span> </span>{

		<span class="hljs-keyword">var</span> i , j , k , a , b , c , n , u , v , sin , cos ;

		n = set.length ;

		each : <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span> ; j &lt; n ; ++j ) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>we need i to be different from j
to have a different from b
i is 1 if j is 0, i is 0 otherwise</p></div></div><div class="code"><div class="wrapper">			i = + ( j === <span class="hljs-number">0</span> ) ;

			a = set[i] ;
			b = set[j] ;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>we initiate u and v to a and
we will update them in a loop
over vertices of the vertex set
in the case we find a better candidate</p></div></div><div class="code"><div class="wrapper">			u = v = a ;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>upon completion of the loop
we will have u and v such that
there is no c in the vertex set such that sin ( a , b , c ) &gt; 0
lying strictly on the right of the line through bu
there is no c in the vertex set such that sin ( a , b , c ) &lt; 0
lying strictly on the left of the line through bv</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">for</span> ( k = <span class="hljs-number">1</span> ; k &lt; n ; ++k ) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>we can always skip k = 0 since i is 0 when j is not
we also skip the cases where c = b or c = a</p></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">if</span> ( k === i || k === j ) <span class="hljs-keyword">continue</span> ;

				c = set[k] ;

				sin = sinsign( a , b , c ) ;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if c is on the left of ab</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><pre><code>|
|</code></pre>
<p>c   b
    |
    a</p></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">if</span> ( sin &gt; <span class="hljs-number">0</span> ) {

					sin = sinsign( b , u , c ) ;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if c is on the right of bu</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>u  c|             u   |
  \ |               \ |
    b  otherwise      b
    |              c  |
    a                 a</p></div></div><div class="code"><div class="wrapper">					<span class="hljs-keyword">if</span> ( sin &lt; <span class="hljs-number">0</span> ) u = c ;

				}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if c is on the right of ab</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><pre><code>|
|
b   c
|
a</code></pre></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( sin &lt; <span class="hljs-number">0</span> ) {

					sin = sinsign( b , v , c ) ;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if c is on the left of bv</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>|c  v             |   v
| /               | /
b      otherwise  b
|                 |  c
a                 a</p></div></div><div class="code"><div class="wrapper">					<span class="hljs-keyword">if</span> ( sin &gt; <span class="hljs-number">0</span> ) v = c ;

				}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>when sin = 0 then we need to check if b
lies on a segment from a to c</p></div></div><div class="code"><div class="wrapper">				<span class="hljs-keyword">else</span> {

					cos = cossign( a , b , c ) ;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>|                     |    |
c                     |    |
|                     |    |
b      otherwise      b or b
|                     c    |
a                     a    a
|                     |    c</p></div></div><div class="code"><div class="wrapper">					<span class="hljs-keyword">if</span> ( cos &lt; <span class="hljs-number">0</span> ) {
						hull[j] = <span class="hljs-literal">false</span> ;
						<span class="hljs-keyword">continue</span> each ;
					}

				}

			}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if we found candidates for both sides of line ab
and b is on the other side of uv relative to a
then b is part of the convex hull</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>u---|---v                 |   v
  \ | /                   b /
    b      otherwise      |
    |                   / |
    a                 u   a</p></div></div><div class="code"><div class="wrapper">			<span class="hljs-keyword">if</span> ( u !== a &amp;&amp; v !== a &amp;&amp; sinsign( u , v , b ) &lt;= <span class="hljs-number">0</span> ) {
				hull[j] = <span class="hljs-literal">false</span> ;
			}

		}

	} ;

	<span class="hljs-keyword">return</span> chn2 ;

} ;

exports.__chn2__ = __chn2__ ;</div></div></div></div></body></html>